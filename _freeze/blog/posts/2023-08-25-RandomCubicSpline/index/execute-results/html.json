{
  "hash": "8307cee022f3b4c5b02c6221cf1de37b",
  "result": {
    "markdown": "---\ntitle: \"Restricted Cubic Spline curve 그리기\"\ndescription: \"RCS curve 그리기 (feat. `plotRCS`)\"\ndate: \"2023-08-25\"\nauthor: \"JYH\"\ncategories: [R, logistic, Cox, RCS, Spline]\nimage: \"https://github.com/KunHuo/plotRCS/raw/master/README-files/README_unnamed-chunk-7-1.png\"\n---\n\n\n헬스케어 분야에서 연구를 하다보면, 특정 변수의 변화에 따라 결과가 어떻게 나타나는지 확인해야하는 경우가 있습니다.\n\n그 중에서 로지스틱 회귀분석으로 산출된 Odds ratio(OR)나 Cox regression을 통한 Hazard ratio(HR)를 3차 곡선으로 표현할 수 있는데요.\n\n바로 Restricted Cubic Spline(RCS) curve 를 이용하는 것입니다.\n\nRCS curve를 이용하면, 공변량을 고려했을 때 특정 변수의 변화에 따라 OR/HR이 어떻게 나타나는지, 그리고 그 차이는 통계적으로 유의미한지 곡선으로 시각화하여 파악할 수 있습니다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages('plotRCS')\nlibrary(plotRCS)\n```\n:::\n\n\n`plotRCS`를 이용하면 RCS curve를 정말 간단하게 그릴 수 있습니다.\n\n`plotRCS` 패키지에 있는 `cancer` 데이터를 사용해 예시를 보여드리겠습니다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(cancer)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"id\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"age\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"sex\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"race\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"size\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"metastasis\"],\"name\":[6],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"status\"],\"name\":[7],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"time\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"10274\",\"2\":\"53\",\"3\":\"Male\",\"4\":\"White\",\"5\":\"27\",\"6\":\"No\",\"7\":\"Censored\",\"8\":\"12\",\"_rn_\":\"1\"},{\"1\":\"56998\",\"2\":\"32\",\"3\":\"Male\",\"4\":\"Black\",\"5\":\"185\",\"6\":\"No\",\"7\":\"Dead\",\"8\":\"5\",\"_rn_\":\"2\"},{\"1\":\"60010\",\"2\":\"69\",\"3\":\"Male\",\"4\":\"White\",\"5\":\"51\",\"6\":\"No\",\"7\":\"Dead\",\"8\":\"13\",\"_rn_\":\"3\"},{\"1\":\"24307\",\"2\":\"61\",\"3\":\"Male\",\"4\":\"White\",\"5\":\"37\",\"6\":\"No\",\"7\":\"Censored\",\"8\":\"50\",\"_rn_\":\"4\"},{\"1\":\"5253\",\"2\":\"53\",\"3\":\"Female\",\"4\":\"White\",\"5\":\"25\",\"6\":\"No\",\"7\":\"Censored\",\"8\":\"27\",\"_rn_\":\"5\"},{\"1\":\"39685\",\"2\":\"56\",\"3\":\"Male\",\"4\":\"Other\",\"5\":\"38\",\"6\":\"No\",\"7\":\"Censored\",\"8\":\"17\",\"_rn_\":\"6\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\n`cancer`데이터는 간암에 대한 데이터로서, 변수들은 크게 다음과 같습니다.\n\n-   age: 나이\n-   sex: 성별 (Male, Female)\n-   race: 인종 (White, Black, Other)\n-   size: 종양의 크기\n-   status: 결과 (Censored, Dead)\n-   time: 관찰기간\n\n## 로지스틱 회귀분석 RCS cure\n\n`rcsplot()` 함수 내에 필요한 인자들만 입력하면 RCS curve가 그려집니다.\n\n입력해줘야 할 인자는 data, outcome, exposure, covariate입니다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrcsplot(\n  data=cancer,\n  outcome='status',\n  exposure='age',\n  covariates=c('sex','race','size', 'metastasis')\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFigure: Association Between age and status Using a Restricted Cubic Spline Regression Model.\nGraphs show ORs for status according to age adjusted for sex, race, size, metastasis. Data were fitted by a logistic regression model, and the model was conducted with 4 knots at the 5th, 35th, 65th, 95th percentiles of age (reference is the 5th percentile). Solid lines indicate ORs, and shadow shape indicate 95% CIs. OR, odds ratio; CI, confidence interval.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n## Cox 회귀분석 RCS curve\n\nCox 회귀분석인 만큼, 기존에 입력하는 변수들과 더불어 시간 변수를 입력해줘야 합니다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrcsplot(\n  data=cancer,\n  outcome='status',\n  exposure='age',\n  time='time',\n  covariates=c('sex','race','size', 'metastasis')\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFigure: Association Between age and status Using a Restricted Cubic Spline Regression Model.\nGraphs show HRs for status according to age adjusted for sex, race, size, metastasis. Data were fitted by a restricted cubic spline Cox proportional hazards regression model, and the model was conducted with 4 knots at the 5th, 35th, 65th, 95th percentiles of age (reference is the 5th percentile). Solid lines indicate HRs, and shadow shape indicate 95% CIs. HR, hazard ratio; CI, confidence interval.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n## 그룹별 RCS curve\n\n`rcsplot()` 함수 내에 `group` 인자를 추가하면, 그룹에 따른 그래프가 그려집니다.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrcsplot(\n  data=cancer,\n  outcome='status',\n  exposure='age',\n  time='time',\n  group='metastasis',\n  covariates=c('sex', 'race','size', 'metastasis')\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nFigure: Association Between age and status Using a Restricted Cubic Spline Regression Model.\nGraphs show HRs for status according to age adjusted for sex, race, size, metastasis. Data were fitted by a restricted cubic spline Cox proportional hazards regression model, and the model was conducted with 4 knots at the 5th, 35th, 65th, 95th percentiles of age (reference is the 5th percentile). Solid lines indicate HRs, and shadow shape indicate 95% CIs. HR, hazard ratio; CI, confidence interval.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\n<script src=\"../../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}