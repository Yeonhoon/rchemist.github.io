<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-03-01">
<meta name="description" content="mlr3를 이용한 하이퍼파라미터 튜닝 학습">

<title>Rchemist - mlr3 하이퍼파라미터 최적화</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

<link href="../../../site_libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="../../../site_libs/pagedtable-1.1/js/pagedtable.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Rchemist</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target=""><i class="bi bi-house" role="img">
</i> 
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../about.html" rel="" target=""><i class="bi bi-file-person" role="img">
</i> 
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../gallery/index.html" rel="" target=""><i class="bi bi-sliders2" role="img">
</i> 
 <span class="menu-text">Gallery</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">mlr3 하이퍼파라미터 최적화</h1>
                  <div>
        <div class="description">
          mlr3를 이용한 하이퍼파라미터 튜닝 학습
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">mlr3</div>
                <div class="quarto-category">machine learning</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 1, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#모델-튜닝하기" id="toc-모델-튜닝하기" class="nav-link active" data-scroll-target="#모델-튜닝하기">모델 튜닝하기</a>
  <ul class="collapse">
  <li><a href="#러너의-학습공간-설정" id="toc-러너의-학습공간-설정" class="nav-link" data-scroll-target="#러너의-학습공간-설정">러너의 학습공간 설정</a></li>
  <li><a href="#터미네이터-terminator" id="toc-터미네이터-terminator" class="nav-link" data-scroll-target="#터미네이터-terminator">터미네이터 (Terminator)</a></li>
  <li><a href="#ti-튜닝-인스턴스" id="toc-ti-튜닝-인스턴스" class="nav-link" data-scroll-target="#ti-튜닝-인스턴스"><code>ti</code>: 튜닝 인스턴스</a></li>
  <li><a href="#tuner" id="toc-tuner" class="nav-link" data-scroll-target="#tuner">Tuner</a></li>
  <li><a href="#튜닝-수행하기" id="toc-튜닝-수행하기" class="nav-link" data-scroll-target="#튜닝-수행하기">튜닝 수행하기</a></li>
  <li><a href="#tune-을-이용한-빠른-튜닝" id="toc-tune-을-이용한-빠른-튜닝" class="nav-link" data-scroll-target="#tune-을-이용한-빠른-튜닝"><code>tune</code> 을 이용한 빠른 튜닝</a></li>
  <li><a href="#튜닝-결과-분석하기" id="toc-튜닝-결과-분석하기" class="nav-link" data-scroll-target="#튜닝-결과-분석하기">튜닝 결과 분석하기</a></li>
  <li><a href="#튜닝된-모델-활용하기" id="toc-튜닝된-모델-활용하기" class="nav-link" data-scroll-target="#튜닝된-모델-활용하기">튜닝된 모델 활용하기</a></li>
  </ul></li>
  <li><a href="#autotuner-로-튜닝-자동화하기" id="toc-autotuner-로-튜닝-자동화하기" class="nav-link" data-scroll-target="#autotuner-로-튜닝-자동화하기"><code>AutoTuner</code> 로 튜닝 자동화하기</a></li>
  <li><a href="#중첩-리샘플링-nested-resampling" id="toc-중첩-리샘플링-nested-resampling" class="nav-link" data-scroll-target="#중첩-리샘플링-nested-resampling">중첩 리샘플링 Nested resampling</a>
  <ul class="collapse">
  <li><a href="#autotuner를-활용한-중첩-리샘플링" id="toc-autotuner를-활용한-중첩-리샘플링" class="nav-link" data-scroll-target="#autotuner를-활용한-중첩-리샘플링">AutoTuner를 활용한 중첩 리샘플링</a></li>
  <li><a href="#성능-비교" id="toc-성능-비교" class="nav-link" data-scroll-target="#성능-비교">성능 비교</a></li>
  <li><a href="#클래스-함수-정리" id="toc-클래스-함수-정리" class="nav-link" data-scroll-target="#클래스-함수-정리">클래스 함수 정리</a></li>
  <li><a href="#참고자료" id="toc-참고자료" class="nav-link" data-scroll-target="#참고자료">참고자료</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
안내사항
</div>
</div>
<div class="callout-body-container callout-body">
<p>이 글은 <a href="https://mlr3book.mlr-org.com/">mlr3book</a><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>을 참고하여 작성되었습니다. 국내 R 사용자들에게 잘 알려지지 않은 <code>mlr3</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> 패키지를 활용하여 R에서도 손쉽게 머신러닝을 수행할 수 있다는 것을 보여드리고자 합니다.</p>
</div>
</div>
<p>머신러닝 알고리즘은 보통 파라미터와 하이퍼파라미터를 포함하고 있습니다. 파라미터란 모델의 회귀계수나 가중치처럼 모델을 만들 때 필요한 매개변수입니다. 반면, 하이퍼파라미터는 사용자에 의해 구성됨으로써 파라미터가 어떻게 나올지를 결정합니다.</p>
<p>대표적인 하이퍼파라미터의 예시로는 랜덤포레스트 알고리즘에서 나무의 개수를 정한다던가, 신경망의 학습률을 조정하는 것 등이 있습니다.</p>
<p>하이퍼파라미터는 어떻게 설정하는지에 따라 모델의 성능을 향상시킬 수도, 그 반대가 될 수도 있습니다. 따라서 하이퍼파라미터를 최적화함으로써, 주어진 태스크에 대해 최적의 알고리즘 모델을 개발하는 것이 필요합니다.</p>
<p>어쩌면 최적의 모델을 구성하는 것이 하나의 러너에 하이퍼 파라미터를 다르게 부여하는 벤치마크 실험을 통해 모델을 선택하는 것과 같다고 생각할 수 있습니다. 예를 들어 랜덤포레스트 모델들을 구성하는 나무의 개수를 다르게 정의하여 성능을 비교해본다고 해봅시다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>bmr <span class="ot">&lt;-</span> <span class="fu">benchmark</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">benchmark_grid</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tasks=</span> <span class="fu">tsk</span>(<span class="st">"penguins_simple"</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">learners =</span> <span class="fu">list</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lrn</span>(<span class="st">"classif.ranger"</span>, <span class="at">num.trees =</span> <span class="dv">1</span>, <span class="at">id=</span><span class="st">"1 tree"</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lrn</span>(<span class="st">"classif.ranger"</span>, <span class="at">num.trees =</span> <span class="dv">10</span>, <span class="at">id=</span><span class="st">"10 tree"</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">lrn</span>(<span class="st">"classif.ranger"</span>, <span class="at">num.trees =</span> <span class="dv">100</span>, <span class="at">id=</span><span class="st">"100 tree"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamplings =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds=</span><span class="dv">3</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(bmr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>결과를 봤을 때, 나무가 100개로 구성된 랜덤포레스트 모델의 성능이 가장 좋은 것으로 나타났습니다. 다만 이렇게 임의적으로 시행착오를 거쳐 하이퍼파라미터를 조정해주는 것은 많은 시간이 필요한 것은 물론, 종종 편향되고 재생산성이 떨어집니다.</p>
<p>지금까지 개발되어온 정교한 하이퍼파라미터 최적화 방법은 종료(termination) 시점까지 반복적으로 다양한 파라미터를 검토 후, 최적의 하이퍼파라미터 구성을 내놓는 효율적이고 로버스트한 결과를 출력합니다.</p>
<section id="모델-튜닝하기" class="level1">
<h1>모델 튜닝하기</h1>
<p><code>mlr3tuning</code> 패키지를 통해 <code>mlr3</code> 생태계에서 하이퍼파라미터 최적화를 수행할 수 있습니다.</p>
<ul>
<li><p><code>TuningInstanceSingleCrit</code>, <code>TuningInstanceMultiCrit</code>: 최적화 결과를 저장하는 튜닝 인스턴스를 만듭니다.</p></li>
<li><p><code>Tuner</code>: 최적의 알고리즘을 불러오고 설정할 때 사용.</p></li>
</ul>
<section id="러너의-학습공간-설정" class="level2">
<h2 class="anchored" data-anchor-id="러너의-학습공간-설정">러너의 학습공간 설정</h2>
<p>각각의 러너들은 search space라고 하는 학습공간을 갖습니다. 이 학습공간은 러너들의 하이퍼파라미터 세트를 설정해줄 수 있는 공간이라고 이해할 수 있습니다.</p>
<p><code>e1071</code> 패키지에 있는 서포트 벡터 머신(SVM)으로 예시를 들어보겠습니다. <code>sonar</code> 데이터를 태스크로 활용하여 SVM 모델을 최적화해봅시다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>lrn_svm <span class="ot">&lt;-</span> <span class="fu">lrn</span>(<span class="st">"classif.svm"</span>, <span class="at">type=</span><span class="st">"C-classification"</span>, <span class="at">kernel =</span> <span class="st">"radial"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>러너의 파라미터 정보는 <code>$param_set</code> 필드에 저장이 됩니다. 여기에는 파라미터의 이름, 클래스의 종류, 레벨, 튜닝 범위 등이 포함되어 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.table</span>(lrn_svm<span class="sc">$</span>param_set)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["id"],"name":[1],"type":["chr"],"align":["left"]},{"label":["class"],"name":[2],"type":["chr"],"align":["left"]},{"label":["lower"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["upper"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["levels"],"name":[5],"type":["list"],"align":["right"]},{"label":["nlevels"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["is_bounded"],"name":[7],"type":["lgl"],"align":["right"]},{"label":["special_vals"],"name":[8],"type":["list"],"align":["right"]},{"label":["default"],"name":[9],"type":["list"],"align":["right"]},{"label":["storage_type"],"name":[10],"type":["chr"],"align":["left"]},{"label":["tags"],"name":[11],"type":["list"],"align":["right"]}],"data":[{"1":"cachesize","2":"ParamDbl","3":"-Inf","4":"Inf","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<int [1]>","10":"numeric","11":"<chr [1]>"},{"1":"class.weights","2":"ParamUty","3":"NA","4":"NA","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<NULL>","10":"list","11":"<chr [1]>"},{"1":"coef0","2":"ParamDbl","3":"-Inf","4":"Inf","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<dbl [1]>","10":"numeric","11":"<chr [1]>"},{"1":"cost","2":"ParamDbl","3":"0","4":"Inf","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<dbl [1]>","10":"numeric","11":"<chr [1]>"},{"1":"cross","2":"ParamInt","3":"0","4":"Inf","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<int [1]>","10":"integer","11":"<chr [1]>"},{"1":"decision.values","2":"ParamLgl","3":"NA","4":"NA","5":"<lgl [2]>","6":"2","7":"TRUE","8":"<list [0]>","9":"<lgl [1]>","10":"logical","11":"<chr [1]>"},{"1":"degree","2":"ParamInt","3":"1","4":"Inf","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<int [1]>","10":"integer","11":"<chr [1]>"},{"1":"epsilon","2":"ParamDbl","3":"0","4":"Inf","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<dbl [1]>","10":"numeric","11":"<chr [1]>"},{"1":"fitted","2":"ParamLgl","3":"NA","4":"NA","5":"<lgl [2]>","6":"2","7":"TRUE","8":"<list [0]>","9":"<lgl [1]>","10":"logical","11":"<chr [1]>"},{"1":"gamma","2":"ParamDbl","3":"0","4":"Inf","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<S3: NoDefault>","10":"numeric","11":"<chr [1]>"},{"1":"kernel","2":"ParamFct","3":"NA","4":"NA","5":"<chr [4]>","6":"4","7":"TRUE","8":"<list [0]>","9":"<chr [1]>","10":"character","11":"<chr [1]>"},{"1":"nu","2":"ParamDbl","3":"-Inf","4":"Inf","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<dbl [1]>","10":"numeric","11":"<chr [1]>"},{"1":"scale","2":"ParamUty","3":"NA","4":"NA","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<lgl [1]>","10":"list","11":"<chr [1]>"},{"1":"shrinking","2":"ParamLgl","3":"NA","4":"NA","5":"<lgl [2]>","6":"2","7":"TRUE","8":"<list [0]>","9":"<lgl [1]>","10":"logical","11":"<chr [1]>"},{"1":"tolerance","2":"ParamDbl","3":"0","4":"Inf","5":"<NULL>","6":"Inf","7":"FALSE","8":"<list [0]>","9":"<dbl [1]>","10":"numeric","11":"<chr [1]>"},{"1":"type","2":"ParamFct","3":"NA","4":"NA","5":"<chr [2]>","6":"2","7":"TRUE","8":"<list [0]>","9":"<chr [1]>","10":"character","11":"<chr [1]>"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>범위가 무한대인 파라미터의 경우 이론상으로는 모든 경우의 수를 고려할 수 있으나, 이는 현실적으로 불가능하죠. 여기서는 일부 하이퍼파라미터를 설정해주도록 하겠습니다.</p>
<p>숫자형 (numeric) 하이퍼파라미터의 경우 반드시 하한과 상한의 범위를 지정해줘야 합니다. 이 때 <code>to_tune()</code> 함수를 이용해주면 됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>lrn_svm <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.svm"</span>,</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">cost =</span> <span class="fu">to_tune</span>(<span class="fl">1e-1</span>, <span class="fl">1e5</span>),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">gamma =</span> <span class="fu">to_tune</span>(<span class="fl">1e-1</span>, <span class="dv">1</span>),</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">"C-classification"</span>,</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">"radial"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>lrn_svm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;LearnerClassifSVM:classif.svm&gt;
* Model: -
* Parameters: cost=&lt;RangeTuneToken&gt;, gamma=&lt;RangeTuneToken&gt;,
  type=C-classification, kernel=radial
* Packages: mlr3, mlr3learners, e1071
* Predict Types:  [response], prob
* Feature Types: logical, integer, numeric
* Properties: multiclass, twoclass</code></pre>
</div>
</div>
<p>학습공간은 주로 머신러닝 모델 설계자의 경험을 바탕으로 구성되는 것이 일반적입니다. 학습공간과 관련된 자세한 사항은 아래에서 추가적으로 다루도록 하겠습니다.</p>
</section>
<section id="터미네이터-terminator" class="level2">
<h2 class="anchored" data-anchor-id="터미네이터-terminator">터미네이터 (Terminator)</h2>
<p>앞서 말한 것처럼 이론적으로는 각 러너들의 모든 학습공간을 탐색하며 성능이 가장 뛰어난 모델을 만들 수 있습니다. 하지만 수학적으로, 그리고 현실적으로는 모든 학습공간을 탐색하기란 불가능합니다. 따라서 특정 알고리즘의 하이퍼파라미터 튜닝 과정 도중, <u><strong>언제 종료할지에 대한 기준</strong></u> 역시 필요합니다.</p>
<p><code>mlr3tuning</code> 패키지에서는 이것을 <code>Terminator</code> 클래스를 통해 구현해놓았습니다. 터미네이터의 종류는 다음과 같습니다.</p>
<table class="table">
<caption><code>Terminator</code> 종류</caption>
<colgroup>
<col style="width: 26%">
<col style="width: 39%">
<col style="width: 34%">
</colgroup>
<thead>
<tr class="header">
<th>종 류</th>
<th>설명</th>
<th>사용예시와 초기 파라미터 설정</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>평가 횟수</td>
<td>특정 탐색횟수가 되면 종료</td>
<td><code>trm("evals", n_evals= 500)</code></td>
</tr>
<tr class="even">
<td>구동 시간</td>
<td>특정 탐색시간이 되면 종료</td>
<td><code>trm("run_time", sec= 100)</code></td>
</tr>
<tr class="odd">
<td>성능 수준</td>
<td>특정 성능에 도달하면 종료</td>
<td><code>trm("perf_reached", level= .1)</code></td>
</tr>
<tr class="even">
<td>시간</td>
<td>특정 현실시간이 되면 종료</td>
<td><code>trm("clock_time", n_evals= 500)</code></td>
</tr>
<tr class="odd">
<td>정체</td>
<td>특정 반복동안 개선이 없으면 종료</td>
<td><code>trm("stagnation", iters= 5, threshold= 1e-5)</code></td>
</tr>
<tr class="even">
<td>조합</td>
<td>여러 터미네이터 조합</td>
<td><code>trm("combo", terminators = list(run_time_100, evals_200), any = TRUE)</code></td>
</tr>
</tbody>
</table>
<p>이 중 가장 많이 활용되는 것은 <code>trm("evals", n_evals= 500)</code> 와 <code>trm("run_time", sec= 100)</code> 입니다. <code>trm("combo")</code>는 여러 가지의 터미너이터를 조합하여 종료기준을 설정합니다. <code>any</code> 또는 <code>all</code>을 통해 여러 조건을 하나만 만족해도 종료할지, 모든 기준을 만족해야 할지 설정할 수 있습니다.</p>
</section>
<section id="ti-튜닝-인스턴스" class="level2">
<h2 class="anchored" data-anchor-id="ti-튜닝-인스턴스"><code>ti</code>: 튜닝 인스턴스</h2>
<p>튜닝 인스턴스는 어떤 모델을 최적화하기 위해 필요한 모든 정보를 갖는 일종의 환경입니다. 어떤 데이터를 어떤 알고리즘을 통해 학습시킬 건지, 어떤 검증전략을 통해 어떤 성능을 기준으로 파라미터들을 평가할 것인지 등의 정보를 담게 됩니다.</p>
<p>이러한 튜닝 인스턴스는 <code>ti()</code> 함수를 통해 사용자가 직접 설정하거나 <code>tune()</code>을 이용해 자동으로 설정할 수 있습니다. 우선은 <code>ti()</code>를 통해 튜닝 인스턴스를 설정하는 방법부터 알아보겠습니다.</p>
<p>튜닝 인스턴스에는 학습시킬 데이터를 갖고 있는 태스크(task), 러너(learner), 리샘플링 (resampling), 성능 측정(measure), 그리고 터미네이터(terminator)가 사용됩니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>resampling <span class="ot">=</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds=</span><span class="dv">3</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>measure <span class="ot">=</span> <span class="fu">msr</span>(<span class="st">"classif.acc"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>learner <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.svm"</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost =</span> <span class="fu">to_tune</span>(<span class="fl">1e-1</span>, <span class="fl">1e5</span>),</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fu">to_tune</span>(<span class="fl">1e-1</span>, <span class="dv">1</span>),</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"radial"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"C-classification"</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>terminator <span class="ot">=</span> <span class="fu">trm</span>(<span class="st">"evals"</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>instance <span class="ot">=</span> <span class="fu">ti</span>(</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">task =</span> <span class="fu">tsk</span>(<span class="st">"sonar"</span>),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">learner =</span> learner,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds=</span><span class="dv">3</span>),</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">measures =</span> measure,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">terminator =</span> terminator</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>instance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;TuningInstanceSingleCrit&gt;
* State:  Not optimized
* Objective: &lt;ObjectiveTuning:classif.svm_on_sonar&gt;
* Search Space:
       id    class lower upper nlevels
   &lt;char&gt;   &lt;char&gt; &lt;num&gt; &lt;num&gt;   &lt;num&gt;
1:   cost ParamDbl   0.1 1e+05     Inf
2:  gamma ParamDbl   0.1 1e+00     Inf
* Terminator: &lt;TerminatorEvals&gt;</code></pre>
</div>
</div>
</section>
<section id="tuner" class="level2">
<h2 class="anchored" data-anchor-id="tuner">Tuner</h2>
<p>튜닝 인스턴스를 만들었다면, 이제 어떻게 튜닝을 할 것인지를 정해야 합니다. <code>mlr3tuning</code> 에는 다양한 <code>Tuner</code> 클래스가 존재합니다.</p>
<table class="table">
<caption><code>mlr3tuning</code>에서 사용가능한 튜닝 알고리즘</caption>
<thead>
<tr class="header">
<th>Tuner</th>
<th>Function call</th>
<th>Package</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Random Search</td>
<td><code>tnr("random_search")</code></td>
<td><a href="https://mlr3tuning.mlr-org.com/"><code>mlr3tuning</code></a></td>
</tr>
<tr class="even">
<td>Grid Search</td>
<td><code>tnr("grid_search")</code></td>
<td><a href="https://mlr3tuning.mlr-org.com/"><code>mlr3tuning</code></a></td>
</tr>
<tr class="odd">
<td>Iterative Racing</td>
<td><code>tnr("irace")</code></td>
<td><a href="https://mlr3tuning.mlr-org.com/"><code>mlr3tuning</code></a></td>
</tr>
<tr class="even">
<td>CMA-ES</td>
<td><code>tnr("cmaes")</code></td>
<td><a href="https://mlr3tuning.mlr-org.com/"><code>mlr3tuning</code></a></td>
</tr>
<tr class="odd">
<td>Bayesian Optimization</td>
<td><code>tnr("mbo")</code></td>
<td><a href="https://mlr3mbo.mlr-org.com/"><code>mlr3mbo</code></a></td>
</tr>
<tr class="even">
<td>Hyperband</td>
<td><code>tnr("hyperband")</code></td>
<td><a href="https://mlr3hyperband.mlr-org.com/"><code>mlr3hyperband</code></a></td>
</tr>
<tr class="odd">
<td>Generalized Simulated Annealing</td>
<td><code>tnr("gensa")</code></td>
<td><a href="https://mlr3tuning.mlr-org.com/"><code>mlr3tuning</code></a></td>
</tr>
<tr class="even">
<td>Nonlinear Optimization</td>
<td><code>tnr("nloptr")</code></td>
<td><a href="https://mlr3tuning.mlr-org.com/"><code>mlr3tuning</code></a></td>
</tr>
</tbody>
</table>
<p>grid search와 random search는 가장 기본적이면서도 많이 사용되는 튜닝 알고리즘입니다. grid search는 학습공간에서 설정한 범위 내의 모든 하이퍼파라미터를 평가하는 반면, random search는 랜덤하게 학습공간을 탐색하여 하이퍼파라미터들을 평가합니다.</p>
<p>grid search와 random search는 나이브(naive)한 알고리즘으로 평가받는데, 이는 하이퍼파라미터들을 평가할 때, 이전 평가값들을 무시하고 새롭게 하이퍼파라미터들을 구성하기 때문입니다.</p>
<p>반면에 Covariance Matrix Adaptation Evolution Strategy (CMA-ES)나 베이지안 최적화와 같은 보다 정교한 알고리즘들은 모델 기반 최적화라고도 볼립니다. 이 알고리즘들은 하이퍼파라미터 평가 과정 중 이전의 평가된 구성으로부터 학습하여 더 좋은 하이퍼파라미터 조합을 더욱 빠르게 찾아냅니다.</p>
<p>앞서 우리가 만들었던 SVM 알고리즘을 튜너를 활용해 하이퍼파라미터를 탐색해보도록 하겠습니다. <code>tnr()</code> 함수를 이용해 튜닝을 수행하는데, <code>batch_size</code>를 설정하여 한 번에 몇 개의 하이퍼파라미터 구성을 평가할지 설정할 수 있습니다. 이 때 설정해주는 <code>resolution</code>의 경우 하이퍼파라미터 조합의 숫자와 연관이 있습니다. 예를 들어 위의 튜닝 인스턴스에서 범위를 정해준 하이퍼파라미터는 두 개 (<code>cost</code>, <code>gamma</code>)입니다. <code>resolution</code>을 5로 설정할 경우 <span class="math inline">\(5^2=25\)</span>, 즉 25번의 하이퍼파라미터 조합이 구성되는 것입니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tuner <span class="ot">=</span> <span class="fu">tnr</span>(<span class="st">"grid_search"</span>, <span class="at">resolution =</span> <span class="dv">5</span>, <span class="at">batch_size =</span> <span class="dv">10</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>tuner</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;TunerGridSearch&gt;: Grid Search
* Parameters: resolution=5, batch_size=10
* Parameter classes: ParamLgl, ParamInt, ParamDbl, ParamFct
* Properties: dependencies, single-crit, multi-crit
* Packages: mlr3tuning</code></pre>
</div>
</div>
</section>
<section id="튜닝-수행하기" class="level2">
<h2 class="anchored" data-anchor-id="튜닝-수행하기">튜닝 수행하기</h2>
<p>이제 하이퍼파라미터 튜닝을 실시해보겠습니다. <code>튜너$optimize(튜닝인스턴스)</code>의 구조로 튜닝을 수행해줍니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tuner<span class="sc">$</span><span class="fu">optimize</span>(instance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["cost"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["gamma"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["learner_param_vals"],"name":[3],"type":["list"],"align":["right"]},{"label":["x_domain"],"name":[4],"type":["list"],"align":["right"]},{"label":["classif.acc"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1e+05","2":"0.1","3":"<named list [4]>","4":"<named list [2]>","5":"0.773706"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="tune-을-이용한-빠른-튜닝" class="level2">
<h2 class="anchored" data-anchor-id="tune-을-이용한-빠른-튜닝"><code>tune</code> 을 이용한 빠른 튜닝</h2>
<p>앞서 <code>ti()</code>를 이용해 튜닝 인스턴스를 설정하고, 터미네이터, 튜너까지 직접 설정해주었는데요. <code>tune()</code> 함수를 이용하면 이러한 튜닝 인스턴스 설정 과정을 간소화할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>learner <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.svm"</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost  =</span> <span class="fu">to_tune</span>(<span class="fl">1e-5</span>, <span class="fl">1e5</span>, <span class="at">logscale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fu">to_tune</span>(<span class="fl">1e-5</span>, <span class="fl">1e5</span>, <span class="at">logscale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"radial"</span>,</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"C-classification"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>instance <span class="ot">=</span> <span class="fu">tune</span>(</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuner =</span> <span class="fu">tnr</span>(<span class="st">"grid_search"</span>, <span class="at">resolution =</span> <span class="dv">5</span>, <span class="at">batch_size =</span> <span class="dv">10</span>),</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">task =</span> <span class="fu">tsk</span>(<span class="st">"sonar"</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">learner =</span> learner,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">3</span>),</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">measures =</span> <span class="fu">msr</span>(<span class="st">"classif.acc"</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>instance<span class="sc">$</span>result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["cost"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["gamma"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["learner_param_vals"],"name":[3],"type":["list"],"align":["right"]},{"label":["x_domain"],"name":[4],"type":["list"],"align":["right"]},{"label":["classif.acc"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"11.51293","2":"-5.756463","3":"<named list [4]>","4":"<named list [2]>","5":"0.831815"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="튜닝-결과-분석하기" class="level2">
<h2 class="anchored" data-anchor-id="튜닝-결과-분석하기">튜닝 결과 분석하기</h2>
<p>ti이나 tune 에 관계없이 하이퍼파라미터 튜닝 이후에는 모든 파라미터 구성이 <code>$archive</code> 필드에 포함되어있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.table</span>(instance<span class="sc">$</span>archive)[,.(cost, gamma, classif.acc)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["cost"],"name":[1],"type":["dbl"],"align":["right"]},{"label":["gamma"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["classif.acc"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"-11.512925","2":"-11.512925","3":"0.5337474"},{"1":"-5.756463","2":"-11.512925","3":"0.5337474"},{"1":"-5.756463","2":"-5.756463","3":"0.5337474"},{"1":"-5.756463","2":"0.000000","3":"0.5337474"},{"1":"-5.756463","2":"11.512925","3":"0.5337474"},{"1":"0.000000","2":"5.756463","3":"0.5337474"},{"1":"5.756463","2":"11.512925","3":"0.5337474"},{"1":"11.512925","2":"-11.512925","3":"0.7550725"},{"1":"11.512925","2":"5.756463","3":"0.5337474"},{"1":"-11.512925","2":"-5.756463","3":"0.5337474"},{"1":"-11.512925","2":"0.000000","3":"0.5337474"},{"1":"0.000000","2":"-11.512925","3":"0.5337474"},{"1":"0.000000","2":"0.000000","3":"0.5337474"},{"1":"5.756463","2":"0.000000","3":"0.5337474"},{"1":"5.756463","2":"5.756463","3":"0.5337474"},{"1":"11.512925","2":"-5.756463","3":"0.8318150"},{"1":"11.512925","2":"11.512925","3":"0.5337474"},{"1":"-11.512925","2":"5.756463","3":"0.5337474"},{"1":"-11.512925","2":"11.512925","3":"0.5337474"},{"1":"-5.756463","2":"5.756463","3":"0.5337474"},{"1":"0.000000","2":"-5.756463","3":"0.7406487"},{"1":"0.000000","2":"11.512925","3":"0.5337474"},{"1":"5.756463","2":"-11.512925","3":"0.7358868"},{"1":"5.756463","2":"-5.756463","3":"0.8318150"},{"1":"11.512925","2":"0.000000","3":"0.5337474"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>결과를 보면 25개의 조합별로 성능 점수(<code>classif.acc</code>, 정확도)가 나와있습니다. 또한 튜닝결과에서는 하이퍼파라미터의 조합별 성능 뿐만 아니라 에러나 경고, 학습된 시간, 모델 학습 시간 등의 정보도 확인할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.data.table</span>(instance<span class="sc">$</span>archive)[,</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  .(timestamp, runtime_learners, errors, warnings)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["timestamp"],"name":[1],"type":["dttm"],"align":["right"]},{"label":["runtime_learners"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["errors"],"name":[3],"type":["int"],"align":["right"]},{"label":["warnings"],"name":[4],"type":["int"],"align":["right"]}],"data":[{"1":"2023-06-26 10:58:25.438103","2":"0.046","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.438103","2":"0.027","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.438103","2":"0.029","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.438103","2":"0.029","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.438103","2":"0.026","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.438103","2":"0.023","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.438103","2":"0.024","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.438103","2":"0.025","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.438103","2":"0.028","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.865979","2":"0.036","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.865979","2":"0.028","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.865979","2":"0.026","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.865979","2":"0.024","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.865979","2":"0.031","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.865979","2":"0.031","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.865979","2":"0.020","3":"0","4":"0"},{"1":"2023-06-26 10:58:25.865979","2":"0.027","3":"0","4":"0"},{"1":"2023-06-26 10:58:26.400233","2":"0.033","3":"0","4":"0"},{"1":"2023-06-26 10:58:26.400233","2":"0.022","3":"0","4":"0"},{"1":"2023-06-26 10:58:26.400233","2":"0.027","3":"0","4":"0"},{"1":"2023-06-26 10:58:26.400233","2":"0.029","3":"0","4":"0"},{"1":"2023-06-26 10:58:26.400233","2":"0.028","3":"0","4":"0"},{"1":"2023-06-26 10:58:26.400233","2":"0.022","3":"0","4":"0"},{"1":"2023-06-26 10:58:26.400233","2":"0.157","3":"0","4":"0"},{"1":"2023-06-26 10:58:26.400233","2":"0.025","3":"0","4":"0"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<p>마지막으로 하이퍼파라미터 튜닝 결과를 <code>mlr3viz</code>를 이용해 시각화할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">autoplot</span>(instance, <span class="at">type=</span><span class="st">"surface"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>cost와 gamma 의 조합에 따른 성능의 정도가 색상으로 나타났습니다. 정확도가 높을수록 히트맵의 색상이 연하다는 것을 확인할 수 있습니다.</p>
</section>
<section id="튜닝된-모델-활용하기" class="level2">
<h2 class="anchored" data-anchor-id="튜닝된-모델-활용하기">튜닝된 모델 활용하기</h2>
<p>튜닝인스턴스에는 튜닝된 결과에 대한 모든 정보를 포함하고 있습니다. instance에 저장된 최적의 파라미터를 활용하여 새로운 러너의 파라미터로 설정해주겠습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>svm_tuned <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.svm"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>svm_tuned<span class="sc">$</span>param_set<span class="sc">$</span>values <span class="ot">=</span> instance<span class="sc">$</span>result_learner_param_vals</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>이제 새로운 러너를 학습하고 결과를 예측할 수 있게 되었습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>svm_tuned<span class="sc">$</span><span class="fu">train</span>(<span class="fu">tsk</span>(<span class="st">"sonar"</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>svm_tuned<span class="sc">$</span>model</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
svm.default(x = data, y = task$truth(), type = "C-classification", 
    kernel = "radial", gamma = 0.00316227766016838, cost = 1e+05, 
    probability = (self$predict_type == "prob"))


Parameters:
   SVM-Type:  C-classification 
 SVM-Kernel:  radial 
       cost:  1e+05 

Number of Support Vectors:  93</code></pre>
</div>
</div>
</section>
</section>
<section id="autotuner-로-튜닝-자동화하기" class="level1">
<h1><code>AutoTuner</code> 로 튜닝 자동화하기</h1>
<p><code>mlr3</code>에서 가장 유용한 기능 중 하나가 <code>AutoTuner</code> 입니다. <code>AutoTuner</code>는 러너를 통해 주어진 하이퍼파라미터를 자동으로 최적화해줌으로써 튜닝과정을 자동으로 수행합니다.</p>
<p>AutoTuner는 러너클래스를 상속받기 때문에 다른 러너들처럼 사용할 수도 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>learner <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.svm"</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost  =</span> <span class="fu">to_tune</span>(<span class="fl">1e-5</span>, <span class="fl">1e5</span>, <span class="at">logscale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fu">to_tune</span>(<span class="fl">1e-5</span>, <span class="fl">1e5</span>, <span class="at">logscale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"radial"</span>,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"C-classification"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>at <span class="ot">=</span> <span class="fu">auto_tuner</span>(</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuner =</span> <span class="fu">tnr</span>(<span class="st">"grid_search"</span>, <span class="at">resolution =</span> <span class="dv">5</span>, <span class="at">batch_size =</span> <span class="dv">5</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">learner =</span> learner,</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">3</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">measure =</span> <span class="fu">msr</span>(<span class="st">"classif.ce"</span>)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>at</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;AutoTuner:classif.svm.tuned&gt;
* Model: list
* Search Space:
&lt;ParamSet&gt;
       id    class     lower    upper nlevels
   &lt;char&gt;   &lt;char&gt;     &lt;num&gt;    &lt;num&gt;   &lt;num&gt;
1:   cost ParamDbl -11.51293 11.51293     Inf
2:  gamma ParamDbl -11.51293 11.51293     Inf
                                                                                     default
                                                                                      &lt;list&gt;
1: &lt;NoDefault&gt;\n  Public:\n    clone: function (deep = FALSE) \n    initialize: function () 
2: &lt;NoDefault&gt;\n  Public:\n    clone: function (deep = FALSE) \n    initialize: function () 
    value
   &lt;list&gt;
1:       
2:       
Trafo is set.
* Packages: mlr3, mlr3tuning, mlr3learners, e1071
* Predict Type: response
* Feature Types: logical, integer, numeric
* Properties: multiclass, twoclass</code></pre>
</div>
</div>
<p>이제 <code>at</code>를 활용해 새로운 데이터를 학습하고 검증 데이터를 통해 모델의 성능을 평가할 수 있습니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>task <span class="ot">=</span> <span class="fu">tsk</span>(<span class="st">"sonar"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>split <span class="ot">=</span> <span class="fu">partition</span>(task)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>at<span class="sc">$</span><span class="fu">train</span>(task, <span class="at">row_ids =</span> split<span class="sc">$</span>train)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>at<span class="sc">$</span><span class="fu">predict</span>(task, <span class="at">row_ids =</span> split<span class="sc">$</span>test)<span class="sc">$</span><span class="fu">score</span>(<span class="fu">msr</span>(<span class="st">"classif.acc"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>classif.acc 
  0.8115942 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>lrn_xgb <span class="ot">&lt;-</span> <span class="fu">lrn</span>(<span class="st">'classif.xgboost'</span>,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>               <span class="at">eta =</span> <span class="fu">to_tune</span>(<span class="fl">1e-4</span>,<span class="fl">1e-2</span>),</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">gamma=</span><span class="fu">to_tune</span>(<span class="fl">1e-3</span>,<span class="fl">1e-2</span>),</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">max_depth=</span><span class="fu">to_tune</span>(<span class="dv">10</span>,<span class="dv">50</span>),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">predict_type=</span><span class="st">'prob'</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>               )</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>at <span class="ot">&lt;-</span> <span class="fu">auto_tuner</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">method=</span><span class="fu">tnr</span>(<span class="st">'random_search'</span>),</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">learner =</span> lrn_xgb,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">'cv'</span>,<span class="at">folds=</span><span class="dv">5</span>),</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">measure =</span> <span class="fu">msr</span>(<span class="st">'classif.auc'</span>),</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">term_evals =</span> <span class="dv">30</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>at<span class="sc">$</span><span class="fu">train</span>(task_sonar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="중첩-리샘플링-nested-resampling" class="level1">
<h1>중첩 리샘플링 Nested resampling</h1>
<p>하이퍼파라미터 최적화는 모델 성능 측정 시 발생할 수 있는 편향을 예방하기 위해 추가적인 리샘플링이 필요합니다. 만약 동일한 데이터가 최적의 하이퍼파라미터를 구성하고 모델링 결과를 평가하는 데 사용된다면 매우 심하게 편향이 있을 수 있습니다.</p>
<p>중첩 리샘플링은 추가적인 리샘플링을 수행함으로써 튜닝된 모델의 성능을 평가하는 과정에서 모델 최적화를 분리시켜 놓습니다. 즉 일반적인 방법의 리샘플링 방법으로 모델의 성능을 평가하는 반면, 튜닝의 경우 리샘플링된 데이터를 다시 리샘플링하여 성능을 평가하는 것입니다.</p>
<p><img src="https://mlr3book.mlr-org.com/chapters/chapter4/Figures/mlr3book_figures-11.svg" class="img-fluid" data-fig-align="center" width="800" alt="중첩 리샘플링 설명도. 초록 상자는 외부 리샘플링을 위한 3-fold 교차검증(CV), 파란색 박스는 하이퍼파라미터 튜닝을 위한 4-fold 교차 검증"> 위의 그림은 중첩 리샘플링의 예시를 잘 보여주고 있습니다.</p>
<ol type="1">
<li>외부 리샘플링: 각기 다른 훈련, 검증 데이터셋을 만들기 위한 3-fold 리샘플링</li>
<li>내부 리샘플링: 외부 리샘플링 안에서 하이퍼파라미터 튜닝을 위한 4-fold 리샘플링</li>
<li>하이퍼파라미터 최적화: 내부 리샘플링 데이터를 활용한 외부 훈련 데이터셋의 하이퍼파라미터 최적화</li>
<li>모델 학습 (Training): 가장 하이퍼파라미터 최적화가 잘된 외부 학습 데이터셋을 활용해 모델 학습</li>
<li>모델 평가 (Evaluation):</li>
<li>교차 검증 (Cross validation): 2~5번 과정을 각 3 fold에서 반복</li>
<li>집계 (Aggregation): 리샘플링의 성능을 집계하여 평가</li>
</ol>
<div class=".callout-tip">
<p>중첩 리샘플링은 컴퓨팅 계산이 굉장히 많이 필요합니다. 위에서 예로 들었던 3-fold 외부 리샘플링과 4-fold 내부 리샘플링, 그리고 grid search를 통한 2가지 파라미터를 5개의 resolution 조합으로 구성할 시, <span class="math inline">\(3*4*5^2 = 300\)</span>번의 모델 학습 및 검증이 이루어지게 됩니다.</p>
</div>
<section id="autotuner를-활용한-중첩-리샘플링" class="level2">
<h2 class="anchored" data-anchor-id="autotuner를-활용한-중첩-리샘플링">AutoTuner를 활용한 중첩 리샘플링</h2>
<p><code>mlr3</code>에선 <code>AutoTuner</code>를 활용한다면 중첩리샘플링도 쉽게 수행이 가능합니다. 코드를 통해 중첩 리샘플링을 살펴보겠습니다.</p>
<p><code>AutoTuner</code> 내부에서 수행하는 리샘플링은 inner resampling으로 4-fold 교차 검증을 수행합니다. 반면에 <code>at</code>를 대상으로 수행하는 <code>resample()</code>의 경우 outer resampling으로 3-fold 교차 검증을 수행합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>learner <span class="ot">=</span> <span class="fu">lrn</span>(<span class="st">"classif.svm"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">cost  =</span> <span class="fu">to_tune</span>(<span class="fl">1e-5</span>, <span class="fl">1e5</span>, <span class="at">logscale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">gamma =</span> <span class="fu">to_tune</span>(<span class="fl">1e-5</span>, <span class="fl">1e5</span>, <span class="at">logscale =</span> <span class="cn">TRUE</span>),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">kernel =</span> <span class="st">"radial"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">"C-classification"</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>at <span class="ot">=</span> <span class="fu">auto_tuner</span>(</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuner =</span> <span class="fu">tnr</span>(<span class="st">"grid_search"</span>, <span class="at">resolution =</span> <span class="dv">5</span>, <span class="at">batch_size =</span> <span class="dv">10</span>),</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">learner =</span> learner,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">resampling =</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">4</span>),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">measure =</span> <span class="fu">msr</span>(<span class="st">"classif.ce"</span>),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>task <span class="ot">=</span> <span class="fu">tsk</span>(<span class="st">"sonar"</span>)</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>outer_resampling <span class="ot">=</span> <span class="fu">rsmp</span>(<span class="st">"cv"</span>, <span class="at">folds =</span> <span class="dv">3</span>)</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>rr <span class="ot">=</span> <span class="fu">resample</span>(task, at, outer_resampling, <span class="at">store_models =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>rr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;ResampleResult&gt; with 3 resampling iterations
 task_id        learner_id resampling_id iteration warnings errors
   sonar classif.svm.tuned            cv         1        0      0
   sonar classif.svm.tuned            cv         2        0      0
   sonar classif.svm.tuned            cv         3        0      0</code></pre>
</div>
</div>
<p>resample()에서 store_models = TRUE 로 설정할 경우, inner tuning 된 AutoTuner 모델들이 저장됩니다. 이를 통해 inner tuning에 대한 정보를 알 수 있습니다.</p>
<p><code>extract_inner_tuning_results()</code>는 최적의 하이퍼파라미터 구성을 보여주고, <code>extract_inner_tuning_archives()</code>는 모든 하이퍼파리미터 기록을 보여줍니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_inner_tuning_results</span>(rr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["iteration"],"name":[1],"type":["int"],"align":["right"]},{"label":["cost"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["gamma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["classif.ce"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["learner_param_vals"],"name":[5],"type":["list"],"align":["right"]},{"label":["x_domain"],"name":[6],"type":["list"],"align":["right"]},{"label":["task_id"],"name":[7],"type":["chr"],"align":["left"]},{"label":["learner_id"],"name":[8],"type":["chr"],"align":["left"]},{"label":["resampling_id"],"name":[9],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"0.000000","3":"-5.756463","4":"0.2384454","5":"<named list [4]>","6":"<named list [2]>","7":"sonar","8":"classif.svm.tuned","9":"cv"},{"1":"2","2":"11.512925","3":"-5.756463","4":"0.2008403","5":"<named list [4]>","6":"<named list [2]>","7":"sonar","8":"classif.svm.tuned","9":"cv"},{"1":"3","2":"5.756463","3":"-5.756463","4":"0.2443277","5":"<named list [4]>","6":"<named list [2]>","7":"sonar","8":"classif.svm.tuned","9":"cv"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">extract_inner_tuning_archives</span>(rr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div data-pagedtable="false">
  <script data-pagedtable-source="" type="application/json">
{"columns":[{"label":["iteration"],"name":[1],"type":["int"],"align":["right"]},{"label":["cost"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["gamma"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["classif.ce"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["x_domain_cost"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["x_domain_gamma"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["runtime_learners"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["timestamp"],"name":[8],"type":["dttm"],"align":["right"]},{"label":["batch_nr"],"name":[9],"type":["int"],"align":["right"]},{"label":["warnings"],"name":[10],"type":["int"],"align":["right"]},{"label":["errors"],"name":[11],"type":["int"],"align":["right"]},{"label":["resample_result"],"name":[12],"type":["list"],"align":["right"]},{"label":["task_id"],"name":[13],"type":["chr"],"align":["left"]},{"label":["learner_id"],"name":[14],"type":["chr"],"align":["left"]},{"label":["resampling_id"],"name":[15],"type":["chr"],"align":["left"]}],"data":[{"1":"1","2":"-11.512925","3":"-5.756463","4":"0.4493697","5":"1.000000e-05","6":"3.162278e-03","7":"0.024","8":"2023-06-26 10:58:28.698662","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"-5.756463","3":"-11.512925","4":"0.4493697","5":"3.162278e-03","6":"1.000000e-05","7":"0.028","8":"2023-06-26 10:58:28.698662","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"-5.756463","3":"-5.756463","4":"0.4493697","5":"3.162278e-03","6":"3.162278e-03","7":"0.030","8":"2023-06-26 10:58:28.698662","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"-5.756463","3":"0.000000","4":"0.4493697","5":"3.162278e-03","6":"1.000000e+00","7":"0.026","8":"2023-06-26 10:58:28.698662","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"0.000000","3":"-11.512925","4":"0.4493697","5":"1.000000e+00","6":"1.000000e-05","7":"0.029","8":"2023-06-26 10:58:28.698662","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"0.000000","3":"11.512925","4":"0.4493697","5":"1.000000e+00","6":"1.000000e+05","7":"0.029","8":"2023-06-26 10:58:28.698662","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"5.756463","3":"-11.512925","4":"0.2752101","5":"3.162278e+02","6":"1.000000e-05","7":"0.025","8":"2023-06-26 10:58:28.698662","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"5.756463","3":"11.512925","4":"0.4493697","5":"3.162278e+02","6":"1.000000e+05","7":"0.064","8":"2023-06-26 10:58:28.698662","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"11.512925","3":"-5.756463","4":"0.2466387","5":"1.000000e+05","6":"3.162278e-03","7":"0.024","8":"2023-06-26 10:58:28.698662","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"-11.512925","3":"11.512925","4":"0.4493697","5":"1.000000e-05","6":"1.000000e+05","7":"0.026","8":"2023-06-26 10:58:29.167150","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"-5.756463","3":"11.512925","4":"0.4493697","5":"3.162278e-03","6":"1.000000e+05","7":"0.032","8":"2023-06-26 10:58:29.167150","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"0.000000","3":"-5.756463","4":"0.2384454","5":"1.000000e+00","6":"3.162278e-03","7":"0.030","8":"2023-06-26 10:58:29.167150","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"0.000000","3":"5.756463","4":"0.4493697","5":"1.000000e+00","6":"3.162278e+02","7":"0.025","8":"2023-06-26 10:58:29.167150","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"5.756463","3":"-5.756463","4":"0.2466387","5":"3.162278e+02","6":"3.162278e-03","7":"0.029","8":"2023-06-26 10:58:29.167150","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"5.756463","3":"0.000000","4":"0.4493697","5":"3.162278e+02","6":"1.000000e+00","7":"0.027","8":"2023-06-26 10:58:29.167150","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"11.512925","3":"-11.512925","4":"0.2901261","5":"1.000000e+05","6":"1.000000e-05","7":"0.026","8":"2023-06-26 10:58:29.167150","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"11.512925","3":"11.512925","4":"0.4493697","5":"1.000000e+05","6":"1.000000e+05","7":"0.026","8":"2023-06-26 10:58:29.167150","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"-11.512925","3":"-11.512925","4":"0.4493697","5":"1.000000e-05","6":"1.000000e-05","7":"0.024","8":"2023-06-26 10:58:29.638967","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"-11.512925","3":"0.000000","4":"0.4493697","5":"1.000000e-05","6":"1.000000e+00","7":"0.030","8":"2023-06-26 10:58:29.638967","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"-11.512925","3":"5.756463","4":"0.4493697","5":"1.000000e-05","6":"3.162278e+02","7":"0.024","8":"2023-06-26 10:58:29.638967","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"-5.756463","3":"5.756463","4":"0.4493697","5":"3.162278e-03","6":"3.162278e+02","7":"0.027","8":"2023-06-26 10:58:29.638967","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"0.000000","3":"0.000000","4":"0.4493697","5":"1.000000e+00","6":"1.000000e+00","7":"0.029","8":"2023-06-26 10:58:29.638967","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"5.756463","3":"5.756463","4":"0.4493697","5":"3.162278e+02","6":"3.162278e+02","7":"0.026","8":"2023-06-26 10:58:29.638967","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"11.512925","3":"0.000000","4":"0.4493697","5":"1.000000e+05","6":"1.000000e+00","7":"0.032","8":"2023-06-26 10:58:29.638967","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"1","2":"11.512925","3":"5.756463","4":"0.4493697","5":"1.000000e+05","6":"3.162278e+02","7":"0.027","8":"2023-06-26 10:58:29.638967","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-11.512925","3":"0.000000","4":"0.5546218","5":"1.000000e-05","6":"1.000000e+00","7":"0.034","8":"2023-06-26 10:58:30.241806","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-11.512925","3":"5.756463","4":"0.5546218","5":"1.000000e-05","6":"3.162278e+02","7":"0.046","8":"2023-06-26 10:58:30.241806","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-5.756463","3":"-11.512925","4":"0.5546218","5":"3.162278e-03","6":"1.000000e-05","7":"0.024","8":"2023-06-26 10:58:30.241806","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-5.756463","3":"-5.756463","4":"0.5546218","5":"3.162278e-03","6":"3.162278e-03","7":"0.033","8":"2023-06-26 10:58:30.241806","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"0.000000","3":"-11.512925","4":"0.5546218","5":"1.000000e+00","6":"1.000000e-05","7":"0.027","8":"2023-06-26 10:58:30.241806","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"5.756463","3":"-11.512925","4":"0.2300420","5":"3.162278e+02","6":"1.000000e-05","7":"0.032","8":"2023-06-26 10:58:30.241806","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"5.756463","3":"0.000000","4":"0.5546218","5":"3.162278e+02","6":"1.000000e+00","7":"0.029","8":"2023-06-26 10:58:30.241806","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"5.756463","3":"5.756463","4":"0.5546218","5":"3.162278e+02","6":"3.162278e+02","7":"0.026","8":"2023-06-26 10:58:30.241806","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"11.512925","3":"-5.756463","4":"0.2008403","5":"1.000000e+05","6":"3.162278e-03","7":"0.031","8":"2023-06-26 10:58:30.241806","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-11.512925","3":"-5.756463","4":"0.5546218","5":"1.000000e-05","6":"3.162278e-03","7":"0.030","8":"2023-06-26 10:58:30.746850","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-11.512925","3":"11.512925","4":"0.5546218","5":"1.000000e-05","6":"1.000000e+05","7":"0.030","8":"2023-06-26 10:58:30.746850","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-5.756463","3":"0.000000","4":"0.5546218","5":"3.162278e-03","6":"1.000000e+00","7":"0.025","8":"2023-06-26 10:58:30.746850","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-5.756463","3":"5.756463","4":"0.5546218","5":"3.162278e-03","6":"3.162278e+02","7":"0.035","8":"2023-06-26 10:58:30.746850","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"0.000000","3":"0.000000","4":"0.5546218","5":"1.000000e+00","6":"1.000000e+00","7":"0.026","8":"2023-06-26 10:58:30.746850","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"0.000000","3":"5.756463","4":"0.5546218","5":"1.000000e+00","6":"3.162278e+02","7":"0.032","8":"2023-06-26 10:58:30.746850","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"11.512925","3":"-11.512925","4":"0.2441176","5":"1.000000e+05","6":"1.000000e-05","7":"0.029","8":"2023-06-26 10:58:30.746850","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"11.512925","3":"5.756463","4":"0.5546218","5":"1.000000e+05","6":"3.162278e+02","7":"0.028","8":"2023-06-26 10:58:30.746850","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-11.512925","3":"-11.512925","4":"0.5546218","5":"1.000000e-05","6":"1.000000e-05","7":"0.029","8":"2023-06-26 10:58:31.235882","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"-5.756463","3":"11.512925","4":"0.5546218","5":"3.162278e-03","6":"1.000000e+05","7":"0.028","8":"2023-06-26 10:58:31.235882","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"0.000000","3":"-5.756463","4":"0.2300420","5":"1.000000e+00","6":"3.162278e-03","7":"0.033","8":"2023-06-26 10:58:31.235882","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"0.000000","3":"11.512925","4":"0.5546218","5":"1.000000e+00","6":"1.000000e+05","7":"0.025","8":"2023-06-26 10:58:31.235882","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"5.756463","3":"-5.756463","4":"0.2008403","5":"3.162278e+02","6":"3.162278e-03","7":"0.031","8":"2023-06-26 10:58:31.235882","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"5.756463","3":"11.512925","4":"0.5546218","5":"3.162278e+02","6":"1.000000e+05","7":"0.033","8":"2023-06-26 10:58:31.235882","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"11.512925","3":"0.000000","4":"0.5546218","5":"1.000000e+05","6":"1.000000e+00","7":"0.029","8":"2023-06-26 10:58:31.235882","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"2","2":"11.512925","3":"11.512925","4":"0.5546218","5":"1.000000e+05","6":"1.000000e+05","7":"0.033","8":"2023-06-26 10:58:31.235882","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-11.512925","3":"-5.756463","4":"0.5607143","5":"1.000000e-05","6":"3.162278e-03","7":"0.032","8":"2023-06-26 10:58:31.875689","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-11.512925","3":"0.000000","4":"0.5607143","5":"1.000000e-05","6":"1.000000e+00","7":"0.033","8":"2023-06-26 10:58:31.875689","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-11.512925","3":"5.756463","4":"0.5607143","5":"1.000000e-05","6":"3.162278e+02","7":"0.030","8":"2023-06-26 10:58:31.875689","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-11.512925","3":"11.512925","4":"0.5607143","5":"1.000000e-05","6":"1.000000e+05","7":"0.033","8":"2023-06-26 10:58:31.875689","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-5.756463","3":"-5.756463","4":"0.5607143","5":"3.162278e-03","6":"3.162278e-03","7":"0.031","8":"2023-06-26 10:58:31.875689","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-5.756463","3":"11.512925","4":"0.5607143","5":"3.162278e-03","6":"1.000000e+05","7":"0.027","8":"2023-06-26 10:58:31.875689","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"0.000000","3":"5.756463","4":"0.5607143","5":"1.000000e+00","6":"3.162278e+02","7":"0.035","8":"2023-06-26 10:58:31.875689","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"5.756463","3":"11.512925","4":"0.5607143","5":"3.162278e+02","6":"1.000000e+05","7":"0.030","8":"2023-06-26 10:58:31.875689","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"11.512925","3":"0.000000","4":"0.5607143","5":"1.000000e+05","6":"1.000000e+00","7":"0.031","8":"2023-06-26 10:58:31.875689","9":"1","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-5.756463","3":"-11.512925","4":"0.5607143","5":"3.162278e-03","6":"1.000000e-05","7":"0.035","8":"2023-06-26 10:58:32.477408","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-5.756463","3":"0.000000","4":"0.5607143","5":"3.162278e-03","6":"1.000000e+00","7":"0.181","8":"2023-06-26 10:58:32.477408","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"0.000000","3":"-11.512925","4":"0.5607143","5":"1.000000e+00","6":"1.000000e-05","7":"0.025","8":"2023-06-26 10:58:32.477408","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"0.000000","3":"-5.756463","4":"0.3600840","5":"1.000000e+00","6":"3.162278e-03","7":"0.026","8":"2023-06-26 10:58:32.477408","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"0.000000","3":"11.512925","4":"0.5607143","5":"1.000000e+00","6":"1.000000e+05","7":"0.024","8":"2023-06-26 10:58:32.477408","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"5.756463","3":"-11.512925","4":"0.3598739","5":"3.162278e+02","6":"1.000000e-05","7":"0.024","8":"2023-06-26 10:58:32.477408","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"5.756463","3":"-5.756463","4":"0.2443277","5":"3.162278e+02","6":"3.162278e-03","7":"0.024","8":"2023-06-26 10:58:32.477408","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"11.512925","3":"-11.512925","4":"0.2953782","5":"1.000000e+05","6":"1.000000e-05","7":"0.030","8":"2023-06-26 10:58:32.477408","9":"2","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-11.512925","3":"-11.512925","4":"0.5607143","5":"1.000000e-05","6":"1.000000e-05","7":"0.027","8":"2023-06-26 10:58:32.917012","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"-5.756463","3":"5.756463","4":"0.5607143","5":"3.162278e-03","6":"3.162278e+02","7":"0.030","8":"2023-06-26 10:58:32.917012","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"0.000000","3":"0.000000","4":"0.5607143","5":"1.000000e+00","6":"1.000000e+00","7":"0.027","8":"2023-06-26 10:58:32.917012","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"5.756463","3":"0.000000","4":"0.5607143","5":"3.162278e+02","6":"1.000000e+00","7":"0.032","8":"2023-06-26 10:58:32.917012","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"5.756463","3":"5.756463","4":"0.5607143","5":"3.162278e+02","6":"3.162278e+02","7":"0.025","8":"2023-06-26 10:58:32.917012","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"11.512925","3":"-5.756463","4":"0.2443277","5":"1.000000e+05","6":"3.162278e-03","7":"0.025","8":"2023-06-26 10:58:32.917012","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"11.512925","3":"5.756463","4":"0.5607143","5":"1.000000e+05","6":"3.162278e+02","7":"0.031","8":"2023-06-26 10:58:32.917012","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"},{"1":"3","2":"11.512925","3":"11.512925","4":"0.5607143","5":"1.000000e+05","6":"1.000000e+05","7":"0.026","8":"2023-06-26 10:58:32.917012","9":"3","10":"0","11":"0","12":"<S3: ResampleResult>","13":"sonar","14":"classif.svm.tuned","15":"cv"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
</div>
</div>
</section>
<section id="성능-비교" class="level2">
<h2 class="anchored" data-anchor-id="성능-비교">성능 비교</h2>
<p>이제, inner tunning과 outer tuning 간의 성능 비교를 통해 모델 과적합 여부를 살펴보겠습니다.</p>
<p><code>{r} extract_inner_tuning_results(rr)[,   .(iteration, cost, gamma, classif.ce)] # inner</code></p>
<p><code>{r} rr$score()[,.(iteration, classif.ce)] # outer</code></p>
<p>외부 리샘플링의 일부 결과에서 확연히 낮은 성능이 나온다는 것은 최적화된 하이퍼파라미터가 데이터에 과적합되었다는 것을 의미합니다. 따라서 튜닝된 모델은 요약계산된 성능으로 보고하는 것이 중요합니다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>rr<span class="sc">$</span><span class="fu">aggregate</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>classif.ce 
 0.2255349 </code></pre>
</div>
</div>
<p>마지막으로 중첩 리샘플링을 과도하게 많이 설정하는 경우, 컴퓨터 성능을 많이 필요로 하게 됩니다. 예를 들어 위의 예시에서는 내부 리샘플링 4, 외부 리샘플링 3, 하이퍼파라미터 2개, resolution 5로 인해 <span class="math inline">\(3*4*5*5=300\)</span>, 즉 300번의 모델 훈련 검증을 수행하게 됩니다. 따라서 내부 리샘플링에서는 홀드아웃 등과 같은 방법을 사용하거나 병렬화를 사용하도록 하는 것을 권장합니다.</p>
<table class="table">
<colgroup>
<col style="width: 25%">
<col style="width: 30%">
<col style="width: 44%">
</colgroup>
<thead>
<tr class="header">
<th>R6 Class</th>
<th>Sugar function</th>
<th>요약</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Tuner</code></td>
<td><code>tnr()</code></td>
<td>최적화 알고리즘 결정</td>
</tr>
<tr class="even">
<td><code>Terminator</code></td>
<td><code>trm()</code></td>
<td>튜닝 알고리즘 종료 시점 기준 설정</td>
</tr>
<tr class="odd">
<td><code>TuningInstanceSingleCrit</code>&nbsp;or&nbsp;<code>TuningInstanceMultiCrit</code></td>
<td><code>ti()</code></td>
<td>튜닝 세팅 저장 및 결과 저장</td>
</tr>
<tr class="even">
<td><code>AutoTuner</code></td>
<td><code>auto_tuner()</code></td>
<td>튜닝과정 자동화</td>
</tr>
<tr class="odd">
<td>-</td>
<td><code>extract_inner_tuning_results()</code></td>
<td>중첩 리샘플링의 내부 튜닝결과 추출</td>
</tr>
<tr class="even">
<td>-</td>
<td><code>extract_inner_tuning_archives()</code></td>
<td>중첩 리샘플링의 내부 튜닝 아카이브 추출</td>
</tr>
</tbody>
</table>
</section>
<section id="클래스-함수-정리" class="level2">
<h2 class="anchored" data-anchor-id="클래스-함수-정리">클래스 함수 정리</h2>
</section>
<section id="참고자료" class="level2">
<h2 class="anchored" data-anchor-id="참고자료">참고자료</h2>
<p><a href="https://mlr3book.mlr-org.com/optimization.html" class="uri">https://mlr3book.mlr-org.com/optimization.html</a></p>


</section>
</section>


<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Back to top</a><div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>https://mlr3book.mlr-org.com/<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>https://mlr3.mlr-org.com/<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="rchemist0123/giscus-blog" data-repo-id="R_kgDOJBwa8Q" data-category="General" data-category-id="DIC_kwDOJBwa8c4CUbVM" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><a href="https://https://rchemistblog.com/">Rchemist</a> © 2023 by <a href="https://https://rchemist.quarto.pub/rchemistblog/about.html">YH Jang</a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:danjang0123@gmail.com">
      <i class="bi bi-envelope" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/danjang0123/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>